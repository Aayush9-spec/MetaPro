(this["webpackJsonpmarketplace-frontend"]=this["webpackJsonpmarketplace-frontend"]||[]).push([[0],{26:function(e){e.exports=JSON.parse('{"contractName":"MarketPlace","abi":[{"inputs":[],"name":"itemCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"items","outputs":[{"internalType":"uint256","name":"Id","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"address","name":"seller","type":"address"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"bool","name":"isSold","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"uint256","name":"_price","type":"uint256"}],"name":"ListItems","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"buyItem","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"},{"internalType":"address","name":"_to","type":"address"}],"name":"transferItem","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_owner","type":"address"}],"name":"getItemByOwner","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"}]}')},38:function(e,t){},49:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var s=a(4),n=a.n(s),i=a(25),c=a.n(i),r=a(10),l=a(26),o=a(2);function d(e){let{item:t,account:a,buyItem:n,transferItem:i,index:c=0}=e;const[l,d]=Object(s.useState)(""),[m,j]=Object(s.useState)(!1);Object(s.useEffect)(()=>{const e=setTimeout(()=>j(!0),Math.min(300,60*c));return()=>clearTimeout(e)},[c]);const u=t.Id?t.Id.toString():"-",h=t.price?r.a.utils.formatEther(t.price):"0",b=t.owner&&a&&t.owner.toLowerCase()===a.toLowerCase(),p=t.owner&&a&&t.owner.toLowerCase()!==a.toLowerCase()&&!t.isSold;return Object(o.jsxs)("div",{className:"item-card ".concat(m?"enter":""),style:{animationDelay:"".concat(60*c,"ms")},children:[Object(o.jsxs)("div",{className:"item-meta",children:[Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"muted",children:["ID: ",u]}),Object(o.jsx)("div",{children:t.name})]}),Object(o.jsxs)("div",{className:"item-price",children:[h," FLOW"]})]}),Object(o.jsxs)("div",{className:"muted",children:["Seller: ",t.seller]}),Object(o.jsxs)("div",{className:"muted",children:["Owner: ",t.owner]}),Object(o.jsxs)("div",{className:"muted",children:["Sold: ",t.isSold?"Yes":"No"]}),Object(o.jsxs)("div",{className:"item-actions",children:[p&&Object(o.jsxs)("button",{className:"btn",onClick:()=>n(t.Id,t.price),"aria-label":"Buy item ".concat(u),children:[Object(o.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:Object(o.jsx)("path",{d:"M7 4h-2l-1 2H2v2h1l3.6 7.59-1.35 2.44A1 1 0 0 0 5.2 19h12v-2H6.42a.25.25 0 0 1-.23-.14L7.1 16h7.45a1 1 0 0 0 .92-.63l2.58-6.97A1 1 0 0 0 17.1 7H6.21l-.94-2z"})}),"Buy"]}),b&&Object(o.jsx)("div",{style:{width:"100%"},children:Object(o.jsxs)("div",{className:"transfer-row",children:[Object(o.jsx)("input",{className:"transfer-input",placeholder:"Transfer to",value:l,onChange:e=>d(e.target.value)}),Object(o.jsxs)("button",{className:"btn ghost",onClick:()=>{i(t.Id,l),d("")},"aria-label":"Transfer item ".concat(u),children:[Object(o.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:Object(o.jsx)("path",{d:"M13 5l7 7-7 7v-4H4v-6h9V5z"})}),"Transfer"]})]})})]})]})}const m=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_CONTRACT_ADDRESS||"0xe9420DC12546ACB7ae36FeAb7739dF5a2adC2180";var j=function(){const[e,t]=Object(s.useState)(()=>{try{return localStorage.getItem("theme")||"dark"}catch(e){return"dark"}});Object(s.useEffect)(()=>{try{document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)}catch(t){}},[e]);const[a,n]=Object(s.useState)(""),[i,c]=Object(s.useState)(""),[j,u]=Object(s.useState)(null),[h,b]=Object(s.useState)([]),[p,O]=Object(s.useState)(!1),[x,w]=Object(s.useState)(""),[y,v]=Object(s.useState)(""),[g,f]=Object(s.useState)(""),[N,S]=Object(s.useState)(""),[C,I]=Object(s.useState)(()=>{try{const e=localStorage.getItem("purchaseHistory");return e?JSON.parse(e):[]}catch(e){return[]}});Object(s.useEffect)(()=>{window.ethereum||alert("Please install MetaMask!")},[]);const T=async e=>{if(e)try{O(!0);const t=(await e.itemCount()).toNumber(),a=[];for(let s=1;s<=t;s++){const t=await e.items(s);a.push(t)}b(a),O(!1)}catch(t){O(!1),console.error("Failed to load items:",t)}},k=async(e,t)=>{if(!j)return alert("Connect wallet first");try{const s=await j.buyItem(e,{value:t,gasLimit:5e5}),n=s.hash;await s.wait();try{const s=e&&e.toString?e.toString():String(e),i=h.find(e=>(e.Id&&e.Id.toString?e.Id.toString():String(e.Id))===s),c=[{id:s,name:i?i.name:"-",price:r.a.utils.formatEther(t),txHash:n,date:(new Date).toISOString()},...C].slice(0,100);I(c);try{localStorage.setItem("purchaseHistory",JSON.stringify(c))}catch(a){}}catch(a){console.warn("Could not record purchase",a)}await T(j)}catch(s){console.error("Failed to buy item:",s)}},L=async(e,t)=>{if(!j)return alert("Connect wallet first");if(!t)return alert("Enter recipient address");try{const a=await j.transferItem(e,t,{gasLimit:5e5});await a.wait(),await T(j)}catch(a){console.error("Failed to transfer item:",a)}};return Object(o.jsxs)("div",{className:"container",children:[Object(o.jsxs)("div",{className:"header",children:[Object(o.jsx)("h2",{className:"title",children:"Flow Marketplace (Simplified)"}),Object(o.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[Object(o.jsx)("button",{className:"btn ghost",onClick:()=>t(e=>"dark"===e?"light":"dark"),title:"Toggle theme","aria-label":"Toggle theme",children:"dark"===e?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:Object(o.jsx)("path",{d:"M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"})}),"Light"]}):Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:Object(o.jsx)("path",{d:"M6.76 4.84l-1.8-1.79L3.17 4.84l1.79 1.79 1.8-1.79zM1 13h3v-2H1v2zm10 9h2v-3h-2v3zm7.03-2.03l1.79 1.79 1.79-1.79-1.79-1.79-1.79 1.79zM20 11v2h3v-2h-3zM4.22 19.78l1.79-1.79-1.79-1.79L2.43 18l1.79 1.78zM11 1h2v3h-2V1zm7.78 4.22l-1.79 1.79 1.79 1.79 1.79-1.79-1.79-1.79z"})}),"Dark"]})}),Object(o.jsx)("input",{className:"input",placeholder:"Search items...",value:x,onChange:e=>w(e.target.value),style:{width:220}}),a?Object(o.jsxs)("div",{className:"wallet-info",children:[Object(o.jsxs)("p",{children:[Object(o.jsx)("b",{children:"Address:"})," ",a]}),Object(o.jsxs)("p",{children:[Object(o.jsx)("b",{children:"Balance:"})," ",i," FLOW / ETH"]})]}):Object(o.jsxs)("button",{className:"btn",onClick:async()=>{if(!window.ethereum)return alert("MetaMask not installed!");try{const e=new r.a.providers.Web3Provider(window.ethereum);await e.send("eth_requestAccounts",[]);const t=e.getSigner(),a=await t.getAddress();n(a);const s=await e.getBalance(a);c(r.a.utils.formatEther(s));const i=new r.a.Contract(m,l,t);u(i),await T(i)}catch(e){console.error("Wallet connection failed:",e)}},"aria-label":"Connect Wallet",children:[Object(o.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:Object(o.jsx)("path",{d:"M21 7H3a1 1 0 00-1 1v10a2 2 0 002 2h16a2 2 0 002-2V8a1 1 0 00-1-1zm-1 10H4V9h16v8zM7 11h10v2H7z"})}),"Connect"]})]})]}),Object(o.jsxs)("div",{className:"section",children:[Object(o.jsx)("h3",{children:"List Item"}),Object(o.jsxs)("div",{className:"form-row",children:[Object(o.jsx)("input",{className:"input",placeholder:"Name",value:y,onChange:e=>v(e.target.value)}),Object(o.jsx)("input",{className:"input small",placeholder:"Price in FLOW/ETH",value:g,onChange:e=>f(e.target.value)}),Object(o.jsx)("button",{className:"btn",onClick:async()=>{if(!j)return alert("Connect wallet first");if(!y||!g)return alert("Enter name and price");try{const e=await j.ListItems(y,r.a.utils.parseEther(g),{gasLimit:5e5});await e.wait(),await T(j),v(""),f("")}catch(e){console.error("Failed to list item:",e)}},children:"List Item"})]})]}),Object(o.jsxs)("div",{className:"section",children:[Object(o.jsx)("h3",{children:"All Items"}),p?Object(o.jsx)("div",{className:"items-grid",children:Array.from({length:6}).map((e,t)=>Object(o.jsxs)("div",{className:"item-card skeleton",children:[Object(o.jsx)("div",{className:"skeleton-title"}),Object(o.jsx)("div",{className:"skeleton-line"}),Object(o.jsx)("div",{className:"skeleton-line short"})]},"skeleton-".concat(t)))}):0===h.length?Object(o.jsx)("p",{className:"muted",children:"No items available"}):Object(o.jsx)("div",{className:"items-grid",children:h.filter(e=>(e.name||"").toLowerCase().includes(x.toLowerCase())).map((e,t)=>Object(o.jsx)(d,{item:e,account:a,buyItem:k,transferItem:L,index:t},e.Id?e.Id.toString():t))})]}),Object(o.jsxs)("div",{className:"section",children:[Object(o.jsx)("h3",{children:"Purchase History"}),0===C.length?Object(o.jsx)("div",{className:"secondary muted",children:"No purchases yet"}):Object(o.jsx)("div",{style:{marginBottom:12},children:Object(o.jsx)("button",{className:"btn ghost",onClick:()=>{I([]);try{localStorage.removeItem("purchaseHistory")}catch(e){}},children:"Clear History"})}),C.length>0&&Object(o.jsx)("div",{className:"items-grid",children:C.map(e=>Object(o.jsxs)("div",{className:"item-card",children:[Object(o.jsxs)("div",{className:"item-meta",children:[Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"muted",children:["ID: ",e.id]}),Object(o.jsx)("div",{children:e.name})]}),Object(o.jsxs)("div",{className:"item-price",children:[e.price," FLOW"]})]}),Object(o.jsxs)("div",{className:"muted",children:["Tx: ",Object(o.jsx)("span",{style:{wordBreak:"break-all"},children:e.txHash})]}),Object(o.jsxs)("div",{className:"muted",children:["When: ",new Date(e.date).toLocaleString()]})]},e.txHash))}),Object(o.jsx)("h3",{children:"Get Items by Owner"}),Object(o.jsxs)("div",{className:"form-row",children:[Object(o.jsx)("input",{className:"input",placeholder:"Owner address",value:N,onChange:e=>S(e.target.value)}),Object(o.jsx)("button",{className:"btn ghost",onClick:async()=>{if(!j)return alert("Connect wallet first");if(!N)return alert("Enter owner address");try{const e=await j.getItemByOwner(N),t=[];for(let a of e){const e=await j.items(a);t.push(e)}b(t)}catch(e){console.error("Failed to get items by owner:",e)}},children:"Get Items"})]})]})]})};a(49);c.a.render(Object(o.jsx)(n.a.StrictMode,{children:Object(o.jsx)(j,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.1705834f.chunk.js.map